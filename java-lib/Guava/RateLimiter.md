# RateLimiter

```md
RateLimiter使用的是一种叫令牌桶的流控算法，RateLimiter会按照一定的频率往桶里扔令牌，线程拿到令牌才能执行，
比如你希望自己的应用程序QPS不要超过1000，那么RateLimiter设置1000的速率后，就会每秒往桶里扔1000个令牌。
```
```md
RateLimiter经常用于限制对一些物理资源或者逻辑资源的访问速率。
与Semaphore 相比，Semaphore 限制了并发访问的数量而不是使用速率。
```
```md
通过设置许可证的速率来定义RateLimiter。
在默认配置下，许可证会在固定的速率下被分配，速率单位是每秒多少个许可证。
为了确保维护配置的速率，许可会被平稳地分配，许可之间的延迟会做调整。
```
```md
可能存在配置一个拥有预热期的RateLimiter 的情况，在这段时间内，每秒分配的许可数会稳定地增长直到达到稳定的速率。
```

* RateLimiter 并不提供公平性的保证。
```md
如果一个高开销的任务抵达一个空闲的 RateLimiter，它会被马上许可，但是下一个请求会经历额外的限制，从而来偿付高开销任务。
```

## SmoothBursty
```md
SmoothBursty 限流器是一种非常简单的限流器，是按照匀速生产令牌的
```
## SmoothWarmingUp
```md
是带有预热机制的限流器。
在实际生产过程中会存在一种情况，当一个服务启动或者长时间没有使用的时候，qps能力会低很多，
而在请求较多的时候qps能力会高很多（比如请求较多的时候，缓存命中率可能会比较高），SmoothWarmingUp限流器就是专门用来应对这种情况的。

SmoothWarmingUp会在低负载的时候按照较慢的速率生成令牌，在高负载的时候按照较快的速率生成令牌。
```